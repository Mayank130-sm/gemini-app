<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SilentScan - AI Disease Detection</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            neonBlue: '#00f2ff',
            darkBg: '#121212',
            darkCard: '#1e1e1e',
            darkerCard: '#0f0f0f', /* Added for modal background */
            errorRed: '#ff4d4d', /* For validation errors */
            successGreen: '#4CAF50', /* For success messages */
          },
          animation: {
            'fade-in': 'fadeIn 0.5s ease-out',
            'fade-out': 'fadeOut 0.5s ease-out forwards',
            'bounce-pulse': 'bounce 1s infinite, pulse 1.5s infinite',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: 0 },
              '100%': { opacity: 1 },
            },
            fadeOut: {
              '0%': { opacity: 1 },
              '100%': { opacity: 0 },
            },
            pulse: {
              '0%, 100%': { transform: 'scale(1)' },
              '50%': { transform: 'scale(1.02)' },
            },
          }
        },
      },
    }
  </script>
  <style id="app-style">
    body {
      background-color: #121212;
      color: #ffffff;
      font-family: 'Inter', sans-serif;
    }
    
    .card {
      background-color: #1e1e1e;
      border: 1px solid #333;
      box-shadow: 0 4px 12px rgba(0, 242, 255, 0.15); /* Slightly stronger neon shadow */
      transition: all 0.3s ease;
    }
    
    .card:hover {
      box-shadow: 0 8px 24px rgba(0, 242, 255, 0.25);
    }
    
    .tab-active {
      color: #00f2ff;
      border-bottom: 2px solid #00f2ff;
      font-weight: 600; /* Make active tab bolder */
    }
    
    .neon-input {
      background-color: #2a2a2a;
      border: 1px solid #333;
      color: #ffffff;
      transition: all 0.3s ease;
      padding: 0.75rem 1rem; /* Increased padding */
    }
    
    .neon-input:focus {
      border-color: #00f2ff;
      box-shadow: 0 0 0 2px rgba(0, 242, 255, 0.3); /* Stronger glow on focus */
      outline: none;
    }

    /* Validation styles */
    .neon-input.invalid {
      border-color: #ff4d4d; /* Error red */
      box-shadow: 0 0 0 2px rgba(255, 77, 77, 0.3);
    }
    .error-message {
      color: #ff4d4d;
      font-size: 0.8rem;
      margin-top: 0.25rem;
    }
    
    .neon-button {
      background: linear-gradient(45deg, #00f2ff, #0080ff); /* Gradient background */
      color: #ffffff;
      border: none; /* No border, let gradient handle it */
      padding: 0.75rem 2rem; /* Increased padding */
      border-radius: 0.5rem; /* Slightly rounded */
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 242, 255, 0.4); /* Neon glow */
      cursor: pointer;
    }
    
    .neon-button:hover {
      transform: translateY(-2px); /* Lift effect */
      box-shadow: 0 8px 25px rgba(0, 242, 255, 0.6); /* Enhanced glow */
    }
    
    .neon-button:active {
      transform: translateY(0);
      box-shadow: 0 2px 10px rgba(0, 242, 255, 0.3);
    }
    
    .module-card {
      min-height: 400px; /* Ensure minimum height */
      max-height: 70vh; /* Cap max height for scrollability */
      overflow-y: auto;
      animation: fadeIn 0.8s ease-out; /* Fade in animation for module content */
    }
    
    .spinner {
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top: 3px solid #00f2ff;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
      display: inline-block;
      vertical-align: middle; /* Align with text */
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: #1e1e1e;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #00f2ff;
    }

    .result-bar {
      height: 8px;
      background: linear-gradient(to right, #00f2ff, #0080ff);
      border-radius: 4px;
      transition: width 0.8s ease-out; /* Smooth width transition */
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(5px); /* Blurred background */
    }

    .modal-content {
      background-color: #1e1e1e;
      padding: 2.5rem;
      border-radius: 1rem;
      box-shadow: 0 10px 30px rgba(0, 242, 255, 0.3);
      max-width: 500px;
      width: 90%;
      text-align: center;
      position: relative;
      animation: fadeIn 0.5s ease-out;
    }

    .modal-close-button {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      color: #00f2ff;
      font-size: 1.5rem;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .modal-close-button:hover {
      transform: rotate(90deg);
    }

    /* Notification styles */
    .notification {
      position: fixed;
      top: 1rem;
      right: 1rem;
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      color: #ffffff;
      font-weight: 500;
      z-index: 1001;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      animation: fade-in 0.5s ease-out;
    }
    .notification.error {
      background-color: #ff4d4d;
    }
    .notification.success {
      background-color: #4CAF50;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <header class="py-6 px-4 sm:px-8 border-b border-gray-800">
    <div class="container mx-auto flex flex-col sm:flex-row justify-between items-center">
      <div class="flex items-center mb-4 sm:mb-0">
        <i class="fas fa-microscope text-neonBlue text-3xl mr-3"></i>
        <h1 class="text-2xl font-bold text-white">Silent<span class="text-neonBlue">Scan</span></h1>
      </div>
      <p class="text-gray-400 text-sm">Privacy-focused disease detection using AI</p>
    </div>
  </header>

  <nav class="w-full border-b border-gray-800 sticky top-0 bg-darkBg z-10">
    <div class="container mx-auto px-4 sm:px-8">
      <div class="flex overflow-x-auto hide-scrollbar" id="tabs">
        <button class="tab-button py-4 px-6 text-gray-300 font-medium tab-active" data-target="breast-cancer">
          <i class="fas fa-heartbeat mr-2"></i>
          Breast Cancer
        </button>
        <button class="tab-button py-4 px-6 text-gray-300 font-medium" data-target="testicular-cancer">
          <i class="fas fa-male mr-2"></i>
          Testicular Cancer
        </button>
        <button class="tab-button py-4 px-6 text-gray-300 font-medium" data-target="pcos">
          <i class="fas fa-female mr-2"></i>
          PCOS
        </button>
        <button class="tab-button py-4 px-6 text-gray-300 font-medium" data-target="sti">
          <i class="fas fa-viruses mr-2"></i>
          STI Detection
        </button>
        <button class="tab-button py-4 px-6 text-gray-300 font-medium" data-target="skin">
          <i class="fas fa-camera-retro mr-2"></i>
          Skin Analysis
        </button>
      </div>
    </div>
  </nav>

  <main class="flex-grow container mx-auto px-4 sm:px-8 py-8">
    <div class="tab-content" id="breast-cancer">
      <h2 class="text-xl font-semibold mb-6 text-neonBlue">Breast Cancer Risk Assessment</h2>
      <div class="card rounded-lg p-6 module-card">
        <form id="breast-cancer-form">
          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Personal Information</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="bc-age" class="block text-sm font-medium text-gray-300 mb-2">Age</label>
                <input type="number" id="bc-age" name="age" min="18" max="100" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 45" required>
                <p class="error-message hidden" id="bc-age-error">Please enter a valid age (18-100).</p>
              </div>
              <div>
                <label for="bc-family-history" class="block text-sm font-medium text-gray-300 mb-2">
                  Family History of Breast Cancer
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="First-degree relative: Parent, sibling, or child. Second-degree relative: Grandparent, aunt/uncle, niece/nephew, or half-sibling."></i>
                </label>
                <select id="bc-family-history" name="family_history" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No family history</option>
                  <option value="1">Second-degree relative</option>
                  <option value="2">First-degree relative</option>
                  <option value="3">Multiple family members</option>
                </select>
              </div>
              <div>
                <label for="bc-previous-biopsy" class="block text-sm font-medium text-gray-300 mb-2">
                  Have you had a previous breast biopsy?
                </label>
                <select id="bc-previous-biopsy" name="previous_biopsy" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes, with benign results</option>
                  <option value="2">Yes, with atypical hyperplasia/LCIS</option>
                </select>
              </div>
              <div>
                <label for="bc-chest-radiation" class="block text-sm font-medium text-gray-300 mb-2">
                  History of radiation therapy to the chest? (e.g., for Hodgkin's lymphoma)
                </label>
                <select id="bc-chest-radiation" name="chest_radiation" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes</option>
                </select>
              </div>
              <div>
                <label for="bc-genetic-mutation" class="block text-sm font-medium text-gray-300 mb-2">
                  Known genetic mutation (e.g., BRCA1/2)?
                </label>
                <select id="bc-genetic-mutation" name="genetic_mutation" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes</option>
                  <option value="2">Unsure / Not tested</option>
                </select>
              </div>
            </div>
          </div>

          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Reproductive Health</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="bc-menstrual-age" class="block text-sm font-medium text-gray-300 mb-2">
                  Age at First Menstruation (when periods began)
                </label>
                <input type="number" id="bc-menstrual-age" name="menstrual_age" min="8" max="18" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 12" required>
                <p class="error-message hidden" id="bc-menstrual-age-error">Enter age (8-18).</p>
              </div>
              <div>
                <label for="bc-first-pregnancy" class="block text-sm font-medium text-gray-300 mb-2">
                  Age at First Full-Term Pregnancy
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="Enter 0 if you have never had a full-term pregnancy."></i>
                </label>
                <input type="number" id="bc-first-pregnancy" name="first_pregnancy" min="0" max="60" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 28 or 0" required>
                <p class="error-message hidden" id="bc-first-pregnancy-error">Enter age (0-60).</p>
              </div>
              <div>
                <label for="bc-num-pregnancies" class="block text-sm font-medium text-gray-300 mb-2">
                  Number of full-term pregnancies
                </label>
                <input type="number" id="bc-num-pregnancies" name="num_pregnancies" min="0" max="15" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 2" required>
                <p class="error-message hidden" id="bc-num-pregnancies-error">Enter number (0-15).</p>
              </div>
              <div>
                <label for="bc-breastfed" class="block text-sm font-medium text-gray-300 mb-2">
                  Have you ever breastfed?
                </label>
                <select id="bc-breastfed" name="breastfed" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes</option>
                </select>
              </div>
              <div>
                <label for="bc-menopause-age" class="block text-sm font-medium text-gray-300 mb-2">
                  Age at Menopause (if applicable)
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="Enter 0 if you have not experienced menopause."></i>
                </label>
                <input type="number" id="bc-menopause-age" name="menopause_age" min="0" max="65" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 52 or 0" required>
                <p class="error-message hidden" id="bc-menopause-age-error">Enter age (0-65).</p>
              </div>
            </div>
          </div>

          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Other Factors</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="bc-density" class="block text-sm font-medium text-gray-300 mb-2">
                  Breast Density (from mammogram report)
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="1: Almost entirely fatty, 2: Scattered fibroglandular densities, 3: Heterogeneously dense, 4: Extremely dense"></i>
                </label>
                <select id="bc-density" name="density" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Almost entirely fatty (A)</option>
                  <option value="2">Scattered fibroglandular densities (B)</option>
                  <option value="3">Heterogeneously dense (C)</option>
                  <option value="4">Extremely dense (D)</option>
                  <option value="0">Unknown</option>
                </select>
              </div>
              <div>
                <label for="bc-hormone-therapy" class="block text-sm font-medium text-gray-300 mb-2">
                  Hormone Therapy (e.g., HRT)
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="Refers to Hormone Replacement Therapy (HRT) or other hormonal treatments for menopausal symptoms."></i>
                </label>
                <select id="bc-hormone-therapy" name="hormone_therapy" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">Never used</option>
                  <option value="1">Previously used</option>
                  <option value="2">Currently using</option>
                </select>
              </div>
              <div>
                <label for="bc-alcohol" class="block text-sm font-medium text-gray-300 mb-2">
                  Alcohol Consumption (drinks per week)
                </label>
                <input type="number" id="bc-alcohol" name="alcohol" min="0" max="50" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 3" required>
                <p class="error-message hidden" id="bc-alcohol-error">Enter number (0-50).</p>
              </div>
              <div>
                <label for="bc-physical-activity" class="block text-sm font-medium text-gray-300 mb-2">
                  Physical Activity (Moderate/Vigorous per week)
                </label>
                <select id="bc-physical-activity" name="physical_activity" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">None or very little</option>
                  <option value="1">1-2 times/week</option>
                  <option value="2">3-4 times/week</option>
                  <option value="3">5+ times/week</option>
                </select>
              </div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <button type="submit" class="neon-button py-2 px-8 rounded-md font-medium">
              Analyze Risk
            </button>
          </div>
        </form>
        <div id="breast-cancer-result" class="hidden">
          <div class="text-center mb-6">
            <span class="inline-block p-3 rounded-full bg-opacity-10 bg-neonBlue mb-4">
              <i class="fas fa-chart-line text-neonBlue text-3xl"></i>
            </span>
            <h3 class="text-xl font-medium">Your Breast Cancer Risk Assessment</h3>
          </div>
          <div class="bg-darkBg p-4 rounded-lg mb-6">
            <div class="flex justify-between items-center mb-2">
              <span class="text-gray-300">Risk Level:</span>
              <span class="text-neonBlue font-medium" id="bc-risk-level">Medium</span>
            </div>
            <div class="mb-2">
              <div class="flex justify-between text-xs text-gray-400 mb-1">
                <span>Low</span>
                <span>Medium</span>
                <span>High</span>
              </div>
              <div class="w-full bg-gray-700 rounded-full h-2">
                <div class="result-bar" id="bc-risk-bar" style="width: 45%"></div>
              </div>
            </div>
            <div class="mt-4">
              <p class="text-gray-300" id="bc-guidance">This is a prototype. When connected to the API, this would show your personalized risk level and guidance.</p>
            </div>
          </div>
          <div class="text-center mt-8">
            <button type="button" class="neon-button py-2 px-8 rounded-md font-medium try-again-btn">
              Try Again
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content hidden" id="testicular-cancer">
      <h2 class="text-xl font-semibold mb-6 text-neonBlue">Testicular Cancer Risk Assessment</h2>
      <div class="card rounded-lg p-6 module-card">
        <form id="testicular-cancer-form">
          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Personal & Medical History</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="tc-age" class="block text-sm font-medium text-gray-300 mb-2">Age</label>
                <input type="number" id="tc-age" name="age" min="15" max="70" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 30" required>
                <p class="error-message hidden" id="tc-age-error">Please enter a valid age (15-70).</p>
              </div>
              <div>
                <label for="tc-race" class="block text-sm font-medium text-gray-300 mb-2">Race/Ethnicity</label>
                <select id="tc-race" name="race" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="white">White / Caucasian</option>
                  <option value="black">Black / African American</option>
                  <option value="asian">Asian</option>
                  <option value="hispanic">Hispanic / Latino</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label for="tc-undescended-testicle" class="block text-sm font-medium text-gray-300 mb-2">
                  History of undescended testicle (Cryptorchidism)?
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="A condition where one or both testicles fail to descend into the scrotum before birth."></i>
                </label>
                <select id="tc-undescended-testicle" name="undescended_testicle" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes, uncorrected</option>
                  <option value="2">Yes, corrected by surgery</option>
                  <option value="3">Unsure</option>
                </select>
              </div>
              <div>
                <label for="tc-family-history" class="block text-sm font-medium text-gray-300 mb-2">
                  Family History of Testicular Cancer
                </label>
                <select id="tc-family-history" name="family_history" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">None</option>
                  <option value="1">Father</option>
                  <option value="2">Brother</option>
                  <option value="3">Other male relative</option>
                  <option value="4">Multiple relatives</option>
                </select>
              </div>
              <div>
                <label for="tc-previous-cancer" class="block text-sm font-medium text-gray-300 mb-2">
                  Personal History of Testicular Cancer?
                </label>
                <select id="tc-previous-cancer" name="previous_cancer" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes, in one testicle</option>
                  <option value="2">Yes, in both testicles</option>
                </select>
              </div>
              <div>
                <label for="tc-klinefelter" class="block text-sm font-medium text-gray-300 mb-2">
                  History of Klinefelter Syndrome (XXY)?
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="A genetic condition where males are born with an extra X chromosome."></i>
                </label>
                <select id="tc-klinefelter" name="klinefelter" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes</option>
                  <option value="2">Unsure</option>
                </select>
              </div>
              <div>
                <label for="tc-hiv" class="block text-sm font-medium text-gray-300 mb-2">
                  HIV infection?
                </label>
                <select id="tc-hiv" name="hiv" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes</option>
                  <option value="2">Unsure</option>
                </select>
              </div>
              <div>
                <label for="tc-mumps-orchitis" class="block text-sm font-medium text-gray-300 mb-2">
                  History of Mumps Orchitis (testicular inflammation from mumps)?
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="Inflammation of the testicle(s) caused by the mumps virus, usually occurring after puberty."></i>
                </label>
                <select id="tc-mumps-orchitis" name="mumps_orchitis" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes</option>
                  <option value="2">Unsure</option>
                </select>
              </div>
              <div>
                <label for="tc-injury" class="block text-sm font-medium text-gray-300 mb-2">
                  History of severe testicular injury/trauma?
                </label>
                <select id="tc-injury" name="injury" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">No</option>
                  <option value="1">Yes</option>
                  <option value="2">Unsure</option>
                </select>
              </div>
            </div>
          </div>
          <div class="mt-8 text-center">
            <button type="submit" class="neon-button py-2 px-8 rounded-md font-medium">
              Analyze Risk
            </button>
          </div>
        </form>
        <div id="testicular-cancer-result" class="hidden">
          <div class="text-center mb-6">
            <span class="inline-block p-3 rounded-full bg-opacity-10 bg-neonBlue mb-4">
              <i class="fas fa-chart-line text-neonBlue text-3xl"></i>
            </span>
            <h3 class="text-xl font-medium">Your Testicular Cancer Risk Assessment</h3>
          </div>
          <div class="bg-darkBg p-4 rounded-lg mb-6">
            <div class="flex justify-between items-center mb-2">
              <span class="text-gray-300">Risk Level:</span>
              <span class="text-neonBlue font-medium" id="tc-risk-level">Medium</span>
            </div>
            <div class="mb-2">
              <div class="flex justify-between text-xs text-gray-400 mb-1">
                <span>Low</span>
                <span>Medium</span>
                <span>High</span>
              </div>
              <div class="w-full bg-gray-700 rounded-full h-2">
                <div class="result-bar" id="tc-risk-bar" style="width: 45%"></div>
              </div>
            </div>
            <div class="mt-4">
              <p class="text-gray-300" id="tc-guidance">This is a prototype. When connected to the API, this would show your personalized risk level and guidance.</p>
            </div>
          </div>
          <div class="text-center mt-8">
            <button type="button" class="neon-button py-2 px-8 rounded-md font-medium try-again-btn">
              Try Again
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-content hidden" id="pcos">
      <h2 class="text-xl font-semibold mb-6 text-neonBlue">PCOS Risk Assessment</h2>
      <div class="card rounded-lg p-6 module-card">
        <form id="pcos-form">
          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Personal & Physical Information</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="pcos-age" class="block text-sm font-medium text-gray-300 mb-2">Age</label>
                <input type="number" id="pcos-age" name="age" min="12" max="55" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 28" required>
                <p class="error-message hidden" id="pcos-age-error">Please enter a valid age (12-55).</p>
              </div>
              <div>
                <label for="pcos-weight" class="block text-sm font-medium text-gray-300 mb-2">Weight (kg)</label>
                <input type="number" id="pcos-weight" name="weight" min="30" max="200" step="0.1" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 65.5" required>
                <p class="error-message hidden" id="pcos-weight-error">Please enter a valid weight (30-200 kg).</p>
              </div>
              <div>
                <label for="pcos-height" class="block text-sm font-medium text-gray-300 mb-2">Height (cm)</label>
                <input type="number" id="pcos-height" name="height" min="120" max="220" step="0.1" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 160.2" required>
                <p class="error-message hidden" id="pcos-height-error">Please enter a valid height (120-220 cm).</p>
              </div>
              <div>
                <label for="pcos-weight-gain" class="block text-sm font-medium text-gray-300 mb-2">
                  Experienced rapid weight gain recently?
                </label>
                <select id="pcos-weight-gain" name="weight_gain" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                </select>
              </div>
              <div>
                <label for="pcos-difficulty-losing-weight" class="block text-sm font-medium text-gray-300 mb-2">
                  Difficulty losing weight (despite diet/exercise)?
                </label>
                <select id="pcos-difficulty-losing-weight" name="difficulty_losing_weight" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                </select>
              </div>
            </div>
          </div>

          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Menstrual & Hormonal Symptoms</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="pcos-cycle" class="block text-sm font-medium text-gray-300 mb-2">
                  Regular Periods
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="A menstrual cycle is generally considered regular if it occurs every 21 to 35 days, with bleeding lasting 2 to 7 days, and varies by no more than a few days from cycle to cycle."></i>
                </label>
                <select id="pcos-cycle" name="regular_periods" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                </select>
              </div>
              <div>
                <label for="pcos-cycle-length" class="block text-sm font-medium text-gray-300 mb-2">
                  Typical Menstrual Cycle Length (days between periods)
                </label>
                <select id="pcos-cycle-length" name="cycle_length" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">Less than 21 days</option>
                  <option value="1">21-35 days</option>
                  <option value="2">More than 35 days</option>
                  <option value="3">Highly irregular / Unpredictable</option>
                  <option value="4">No periods (amenorrhea)</option>
                </select>
              </div>
              <div>
                <label for="pcos-periods-per-year" class="block text-sm font-medium text-gray-300 mb-2">
                  Approximate number of periods per year
                </label>
                <input type="number" id="pcos-periods-per-year" name="periods_per_year" min="0" max="15" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 8" required>
                <p class="error-message hidden" id="pcos-periods-per-year-error">Enter number (0-15).</p>
              </div>
              <div>
                <label for="pcos-hair-growth" class="block text-sm font-medium text-gray-300 mb-2">
                  Excess Hair Growth (Hirsutism)
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="Unwanted hair growth in a male-like pattern (e.g., face, chest, back, abdomen)."></i>
                </label>
                <select id="pcos-hair-growth" name="hair_growth" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">None</option>
                  <option value="1">Mild</option>
                  <option value="2">Moderate</option>
                  <option value="3">Severe</option>
                </select>
              </div>
              <div>
                <label for="pcos-hair-loss" class="block text-sm font-medium text-gray-300 mb-2">
                  Hair Loss (Male-pattern baldness/thinning)
                </label>
                <select id="pcos-hair-loss" name="hair_loss" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                </select>
              </div>
              <div>
                <label for="pcos-acne-severity" class="block text-sm font-medium text-gray-300 mb-2">
                  Acne Severity
                </label>
                <select id="pcos-acne-severity" name="acne_severity" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="0">None</option>
                  <option value="1">Mild (occasional breakouts)</option>
                  <option value="2">Moderate (frequent breakouts)</option>
                  <option value="3">Severe (cystic or widespread)</option>
                </select>
              </div>
              <div>
                <label for="pcos-skin" class="block text-sm font-medium text-gray-300 mb-2">
                  Skin Darkening (Acanthosis Nigricans)
                  <i class="fas fa-info-circle text-gray-500 cursor-pointer ml-1" title="Dark, velvety patches of skin, typically in the armpits, groin, neck, or under breasts."></i>
                </label>
                <select id="pcos-skin" name="skin_darkening" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                </select>
              </div>
            </div>
          </div>

          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Other Health Indicators</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="pcos-ovarian-cysts" class="block text-sm font-medium text-gray-300 mb-2">
                  History of ovarian cysts (diagnosed by ultrasound)?
                </label>
                <select id="pcos-ovarian-cysts" name="ovarian_cysts" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                  <option value="2">Unsure</option>
                </select>
              </div>
              <div>
                <label for="pcos-gestational-diabetes" class="block text-sm font-medium text-gray-300 mb-2">
                  History of gestational diabetes?
                </label>
                <select id="pcos-gestational-diabetes" name="gestational_diabetes" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                  <option value="2">Not applicable</option>
                </select>
              </div>
              <div>
                <label for="pcos-family-diabetes" class="block text-sm font-medium text-gray-300 mb-2">
                  Family history of Type 2 Diabetes?
                </label>
                <select id="pcos-family-diabetes" name="family_diabetes" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                  <option value="2">Unsure</option>
                </select>
              </div>
              <div>
                <label for="pcos-insulin-resistance" class="block text-sm font-medium text-gray-300 mb-2">
                  Ever told you have insulin resistance or pre-diabetes?
                </label>
                <select id="pcos-insulin-resistance" name="insulin_resistance" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                  <option value="2">Unsure</option>
                </select>
              </div>
              <div>
                <label for="pcos-anxiety-depression" class="block text-sm font-medium text-gray-300 mb-2">
                  Experienced significant anxiety or depression?
                </label>
                <select id="pcos-anxiety-depression" name="anxiety_depression" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                </select>
              </div>
              <div>
                <label for="pcos-sleep-issues" class="block text-sm font-medium text-gray-300 mb-2">
                  Do you experience snoring or excessive daytime sleepiness?
                </label>
                <select id="pcos-sleep-issues" name="sleep_issues" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1">Yes</option>
                  <option value="0">No</option>
                </select>
              </div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <button type="submit" class="neon-button py-2 px-8 rounded-md font-medium">
              Analyze Risk
            </button>
          </div>
        </form>
        <div id="pcos-result" class="hidden">
          <div class="text-center mb-6">
            <span class="inline-block p-3 rounded-full bg-opacity-10 bg-neonBlue mb-4">
              <i class="fas fa-chart-bar text-neonBlue text-3xl"></i>
            </span>
            <h3 class="text-xl font-medium">Your PCOS Risk Assessment</h3>
          </div>
          <div class="bg-darkBg p-4 rounded-lg mb-6">
            <div class="flex justify-between items-center mb-2">
              <span class="text-gray-300">Risk Level:</span>
              <span class="text-neonBlue font-medium" id="pcos-risk-level">Medium</span>
            </div>
            <div class="mb-2">
              <div class="flex justify-between text-xs text-gray-400 mb-1">
                <span>Low</span>
                <span>Medium</span>
                <span>High</span>
              </div>
              <div class="w-full bg-gray-700 rounded-full h-2">
                <div class="result-bar" id="pcos-risk-bar" style="width: 70%"></div>
              </div>
            </div>
            <div class="mt-4">
              <p class="text-gray-300" id="pcos-guidance">This is a prototype. When connected to the API, this would show your personalized risk level and guidance.</p>
            </div>
          </div>
          <div class="text-center mt-8">
            <button type="button" class="neon-button py-2 px-8 rounded-md font-medium try-again-btn">
              Try Again
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content hidden" id="sti">
      <h2 class="text-xl font-semibold mb-6 text-neonBlue">STI Symptom Classifier</h2>
      <div class="card rounded-lg p-6 module-card">
        <form id="sti-form">
          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Current Symptoms</h3>
            <p class="text-gray-300 text-sm mb-4">Please select all symptoms you are currently experiencing:</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="flex items-center">
                <input type="checkbox" id="sti-itching" name="symptoms" value="itching" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-itching" class="ml-3 text-gray-300">Genital Itching</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-burning" name="symptoms" value="burning" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-burning" class="ml-3 text-gray-300">Burning sensation (genital area)</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-pain-urination" name="symptoms" value="pain_urination" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-pain-urination" class="ml-3 text-gray-300">Pain during urination</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-discharge" name="symptoms" value="unusual_discharge" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-discharge" class="ml-3 text-gray-300">Unusual discharge</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-odor" name="symptoms" value="unusual_odor" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-odor" class="ml-3 text-gray-300">Unusual odor (genital area)</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-sores" name="symptoms" value="sores_lesions" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-sores" class="ml-3 text-gray-300">Sores, blisters, or lesions</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-rash" name="symptoms" value="rash" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-rash" class="ml-3 text-gray-300">Rash (genital or other areas)</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-bleeding" name="symptoms" value="unusual_bleeding" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-bleeding" class="ml-3 text-gray-300">Unusual bleeding (not menstrual)</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-swelling" name="symptoms" value="swelling" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-swelling" class="ml-3 text-gray-300">Swelling in genital/groin area</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-pelvic-pain" name="symptoms" value="pelvic_pain" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-pelvic-pain" class="ml-3 text-gray-300">Pelvic or lower abdominal pain</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-fatigue" name="symptoms" value="fatigue" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-fatigue" class="ml-3 text-gray-300">Fatigue or general malaise</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-fever" name="symptoms" value="fever" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-fever" class="ml-3 text-gray-300">Fever or chills</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-lymph-nodes" name="symptoms" value="swollen_lymph_nodes" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-lymph-nodes" class="ml-3 text-gray-300">Swollen lymph nodes (e.g., in groin)</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-sore-throat" name="symptoms" value="sore_throat" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-sore-throat" class="ml-3 text-gray-300">Sore throat</label>
              </div>
              <div class="flex items-center">
                <input type="checkbox" id="sti-none" name="symptoms" value="none" class="h-4 w-4 text-neonBlue focus:ring-neonBlue border-gray-500 rounded">
                <label for="sti-none" class="ml-3 text-gray-300">None of these symptoms apply</label>
              </div>
            </div>
          </div>

          <div class="mb-8" id="sti-detail-questions">
            <h3 class="text-lg font-medium text-white mb-4">Symptom Details & History</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="sti-symptom-onset" class="block text-sm font-medium text-gray-300 mb-2">
                  When did symptoms first appear?
                </label>
                <select id="sti-symptom-onset" name="symptom_onset" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="1_week">Less than 1 week ago</option>
                  <option value="1_4_weeks">1 to 4 weeks ago</option>
                  <option value="1_3_months">1 to 3 months ago</option>
                  <option value="3_months_plus">More than 3 months ago</option>
                  <option value="not_applicable">Not applicable / No symptoms</option>
                </select>
              </div>
              <div>
                <label for="sti-symptom-change" class="block text-sm font-medium text-gray-300 mb-2">
                  Have your symptoms changed over time?
                </label>
                <select id="sti-symptom-change" name="symptom_change" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="worse">Gotten worse</option>
                  <option value="same">Stayed the same</option>
                  <option value="better">Gotten better</option>
                  <option value="new_appeared">New symptoms appeared</option>
                  <option value="not_applicable">Not applicable / No symptoms</option>
                </select>
              </div>
              <div id="sti-discharge-details" class="col-span-full md:col-span-1 hidden">
                <label for="sti-discharge-color" class="block text-sm font-medium text-gray-300 mb-2">
                  Discharge color:
                </label>
                <input type="text" id="sti-discharge-color" name="discharge_color" class="w-full rounded-md p-2 neon-input" placeholder="e.g., clear, white, yellow, green">
              </div>
              <div id="sti-discharge-consistency-details" class="col-span-full md:col-span-1 hidden">
                <label for="sti-discharge-consistency" class="block text-sm font-medium text-gray-300 mb-2">
                  Discharge consistency:
                </label>
                <input type="text" id="sti-discharge-consistency" name="discharge_consistency" class="w-full rounded-md p-2 neon-input" placeholder="e.g., thin, thick, foamy, cottage cheese-like">
              </div>
              <div id="sti-sores-details" class="col-span-full hidden">
                <label for="sti-sores-description" class="block text-sm font-medium text-gray-300 mb-2">
                  Describe sores/lesions:
                </label>
                <input type="text" id="sti-sores-description" name="sores_description" class="w-full rounded-md p-2 neon-input" placeholder="e.g., small blisters, painless ulcers, warts">
              </div>
            </div>
          </div>

          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Sexual Health History</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="sti-partners-last-months" class="block text-sm font-medium text-gray-300 mb-2">
                  Number of sexual partners in the last 6 months (Optional)
                </label>
                <input type="number" id="sti-partners-last-months" name="partners_last_months" min="0" max="99" class="w-full rounded-md p-2 neon-input" placeholder="e.g., 1 or 0">
              </div>
              <div>
                <label for="sti-sexual-contact-type" class="block text-sm font-medium text-gray-300 mb-2">
                  Type of sexual contact (Optional)
                </label>
                <select id="sti-sexual-contact-type" name="sexual_contact_type" class="w-full rounded-md p-2 neon-input" multiple>
                  <option value="vaginal">Vaginal</option>
                  <option value="anal">Anal</option>
                  <option value="oral">Oral</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label for="sti-condom-usage" class="block text-sm font-medium text-gray-300 mb-2">
                  Condom usage with new partners (Optional)
                </label>
                <select id="sti-condom-usage" name="condom_usage" class="w-full rounded-md p-2 neon-input">
                  <option value="">Select option</option>
                  <option value="always">Always</option>
                  <option value="sometimes">Sometimes</option>
                  <option value="never">Never</option>
                  <option value="not_applicable">Not applicable</option>
                </select>
              </div>
              <div>
                <label for="sti-last-unprotected" class="block text-sm font-medium text-gray-300 mb-2">
                  Date of last unprotected sexual encounter (Optional)
                </label>
                <input type="date" id="sti-last-unprotected" name="last_unprotected" class="w-full rounded-md p-2 neon-input">
              </div>
              <div>
                <label for="sti-partner-symptoms" class="block text-sm font-medium text-gray-300 mb-2">
                  Do any of your partners have symptoms? (Optional)
                </label>
                <select id="sti-partner-symptoms" name="partner_symptoms" class="w-full rounded-md p-2 neon-input">
                  <option value="">Select option</option>
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                  <option value="unsure">Unsure</option>
                </select>
              </div>
              <div>
                <label for="sti-previous-diagnosis" class="block text-sm font-medium text-gray-300 mb-2">
                  Have you been diagnosed with an STI before? (Optional)
                </label>
                <select id="sti-previous-diagnosis" name="previous_diagnosis" class="w-full rounded-md p-2 neon-input">
                  <option value="">Select option</option>
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                  <option value="unsure">Unsure</option>
                </select>
              </div>
            </div>
          </div>
          
          <div class="mt-8 text-center">
            <button type="submit" class="neon-button py-2 px-8 rounded-md font-medium">
              Analyze Symptoms
            </button>
          </div>
        </form>
        <div id="sti-result" class="hidden">
          <div class="text-center mb-6">
            <span class="inline-block p-3 rounded-full bg-opacity-10 bg-neonBlue mb-4">
              <i class="fas fa-clipboard-list text-neonBlue text-3xl"></i>
            </span>
            <h3 class="text-xl font-medium">Symptom Analysis Results</h3>
          </div>
          <div class="bg-darkBg p-4 rounded-lg mb-6">
            <p class="text-sm text-gray-400 mb-4">Based on the symptoms you reported, our system has identified possible conditions:</p>
            <div id="sti-conditions" class="space-y-4">
              <div class="p-3 border border-gray-700 rounded-lg">
                <div class="flex justify-between items-center">
                  <span class="text-gray-300 font-medium">Condition 1</span>
                  <span class="text-neonBlue">85% match</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2 mt-2">
                  <div class="result-bar" style="width: 85%"></div>
                </div>
              </div>
              <div class="p-3 border border-gray-700 rounded-lg">
                <div class="flex justify-between items-center">
                  <span class="text-gray-300 font-medium">Condition 2</span>
                  <span class="text-neonBlue">45% match</span>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2 mt-2">
                  <div class="result-bar" style="width: 45%"></div>
                </div>
              </div>
            </div>
            <div class="mt-6">
              <p class="text-gray-300" id="sti-guidance">This is a prototype. When connected to the API, this would show your personalized analysis and guidance.</p>
              <p class="text-sm text-gray-400 mt-3">Note: This is not a diagnosis. Please consult with a healthcare provider for proper medical evaluation.</p>
            </div>
          </div>
          <div class="text-center mt-8">
            <button type="button" class="neon-button py-2 px-8 rounded-md font-medium try-again-btn">
              Try Again
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content hidden" id="skin">
      <h2 class="text-xl font-semibold mb-6 text-neonBlue">Skin Disorder Detection</h2>
      <div class="card rounded-lg p-6 module-card">
        <form id="skin-form">
          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Upload Image</h3>
            <div class="text-center mb-6">
              <div class="mx-auto w-48 h-48 bg-gray-800 rounded-lg flex items-center justify-center overflow-hidden relative" id="image-preview-container">
                <i class="fas fa-image text-4xl text-gray-600" id="image-placeholder"></i>
                <img id="image-preview" class="w-full h-full object-cover hidden" alt="Preview" />
                <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity cursor-pointer" id="change-image-overlay">
                  <span class="text-white text-sm">Click to upload/change image</span>
                </div>
              </div>
            </div>
            <div class="mt-4">
              <label class="block text-sm font-medium text-gray-300 mb-2">Upload Skin Image</label>
              <div class="mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-700 border-dashed rounded-md">
                <div class="space-y-1 text-center">
                  <i class="fas fa-cloud-upload-alt text-gray-400 text-2xl"></i>
                  <div class="flex text-sm text-gray-400 mt-2">
                    <label for="skin-image" class="relative cursor-pointer bg-darkCard rounded-md font-medium text-neonBlue hover:text-neonBlue-light focus-within:outline-none">
                      <span>Upload an image</span>
                      <input id="skin-image" name="skin_image" type="file" class="sr-only" accept="image/*" required>
                    </label>
                    <p class="pl-1">or drag and drop</p>
                  </div>
                  <p class="text-xs text-gray-400">
                    PNG, JPG, JPEG up to 10MB. For best results, upload a clear, well-lit image of the affected area.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="mb-8">
            <h3 class="text-lg font-medium text-white mb-4">Symptom Details</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="skin-location" class="block text-sm font-medium text-gray-300 mb-2">Body Location</label>
                <select id="skin-location" name="body_location" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select location</option>
                  <option value="face">Face</option>
                  <option value="scalp">Scalp</option>
                  <option value="neck">Neck</option>
                  <option value="chest">Chest</option>
                  <option value="back">Back</option>
                  <option value="arm">Arm</option>
                  <option value="hand">Hand</option>
                  <option value="leg">Leg</option>
                  <option value="foot">Foot</option>
                  <option value="genitals">Genital area</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label for="skin-onset" class="block text-sm font-medium text-gray-300 mb-2">When did you first notice it?</label>
                <select id="skin-onset" name="onset" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="days">Few days ago</option>
                  <option value="weeks">1-4 weeks ago</option>
                  <option value="months">1-6 months ago</option>
                  <option value="years">More than 6 months ago</option>
                </select>
              </div>
              <div>
                <label for="skin-change" class="block text-sm font-medium text-gray-300 mb-2">Has it changed in size, shape, or color recently?</label>
                <select id="skin-change" name="change_recent" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="yes_worse">Yes, gotten worse</option>
                  <option value="yes_better">Yes, gotten better</option>
                  <option value="no_same">No, stayed the same</option>
                  <option value="unsure">Unsure</option>
                </select>
              </div>
              <div>
                <label for="skin-itchy" class="block text-sm font-medium text-gray-300 mb-2">Is it itchy?</label>
                <select id="skin-itchy" name="itchy" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                  <option value="sometimes">Sometimes</option>
                </select>
              </div>
              <div>
                <label for="skin-painful" class="block text-sm font-medium text-gray-300 mb-2">Is it painful?</label>
                <select id="skin-painful" name="painful" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                  <option value="sometimes">Sometimes</option>
                </select>
              </div>
              <div>
                <label for="skin-raised-flat" class="block text-sm font-medium text-gray-300 mb-2">Is it raised or flat?</label>
                <select id="skin-raised-flat" name="raised_flat" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="raised">Raised</option>
                  <option value="flat">Flat</option>
                  <option value="mixed">Mixed (partly raised, partly flat)</option>
                </select>
              </div>
              <div>
                <label for="skin-discharge" class="block text-sm font-medium text-gray-300 mb-2">Any fluid/discharge from it?</label>
                <select id="skin-discharge" name="discharge" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                </select>
              </div>
              <div id="skin-appearance-section">
                <label for="skin-appearance" class="block text-sm font-medium text-gray-300 mb-2">Describe its appearance (select all that apply)</label>
                <select id="skin-appearance" name="appearance" class="w-full rounded-md p-2 neon-input" multiple>
                  <option value="redness">Redness</option>
                  <option value="bumps">Bumps/Lumps</option>
                  <option value="blisters">Blisters</option>
                  <option value="scaly">Scaly patches</option>
                  <option value="crusty">Crusty/Scabbed</option>
                  <option value="ulcers">Ulcers/Open sores</option>
                  <option value="dark_spots">Dark spots/Moles</option>
                  <option value="irregular_shape">Irregular shape/borders</option>
                  <option value="uneven_color">Uneven color</option>
                  <option value="pus">Pus</option>
                </select>
              </div>
              <div>
                <label for="skin-triggers" class="block text-sm font-medium text-gray-300 mb-2">Any known triggers/aggravating factors? (Optional)</label>
                <input type="text" id="skin-triggers" name="triggers" class="w-full rounded-md p-2 neon-input" placeholder="e.g., sun exposure, certain foods, stress, scratching">
              </div>
              <div>
                <label for="skin-allergies-eczema" class="block text-sm font-medium text-gray-300 mb-2">History of allergies, eczema, or psoriasis?</label>
                <select id="skin-allergies-eczema" name="allergies_eczema" class="w-full rounded-md p-2 neon-input" required>
                  <option value="">Select option</option>
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                  <option value="unsure">Unsure</option>
                </select>
              </div>
              <div>
                <label for="skin-medications" class="block text-sm font-medium text-gray-300 mb-2">Are you on any medications that might cause skin reactions? (Optional)</label>
                <input type="text" id="skin-medications" name="medications" class="w-full rounded-md p-2 neon-input" placeholder="List medications if any">
              </div>
            </div>
          </div>

          <div class="mt-8 text-center">
            <button type="submit" class="neon-button py-2 px-8 rounded-md font-medium">
              Analyze Image
            </button>
          </div>
        </form>
        <div id="skin-result" class="hidden">
          <div class="text-center mb-6">
            <span class="inline-block p-3 rounded-full bg-opacity-10 bg-neonBlue mb-4">
              <i class="fas fa-microscope text-neonBlue text-3xl"></i>
            </span>
            <h3 class="text-xl font-medium">Skin Analysis Results</h3>
          </div>
          <div class="flex flex-col md:flex-row gap-6">
            <div class="md:w-1/3">
              <div class="w-full h-48 bg-gray-800 rounded-lg overflow-hidden">
                <img id="result-image-preview" class="w-full h-full object-cover" alt="Analyzed image" />
              </div>
            </div>
            <div class="md:w-2/3 bg-darkBg p-4 rounded-lg">
              <div class="mb-4">
                <h4 class="font-medium text-neonBlue mb-2">Detected Condition</h4>
                <p class="text-xl text-white" id="skin-condition-name">Condition Name</p>
              </div>
              <div class="mb-4">
                <h4 class="font-medium text-neonBlue mb-2">Confidence Level</h4>
                <div class="flex items-center">
                  <div class="w-full bg-gray-700 rounded-full h-2 mr-2">
                    <div class="result-bar" id="skin-confidence-bar" style="width: 75%"></div>
                  </div>
                  <span class="text-white" id="skin-confidence">75%</span>
                </div>
              </div>
              <div class="mb-4">
                <h4 class="font-medium text-neonBlue mb-2">Guidance</h4>
                <p class="text-gray-300" id="skin-guidance">This is a prototype. When connected to the API, this would show information about the detected condition and recommended next steps.</p>
              </div>
              <div class="text-sm text-gray-400 mt-6">
                <p>Note: This analysis is not a diagnosis. Please consult with a dermatologist or healthcare provider for proper medical evaluation.</p>
              </div>
            </div>
          </div>
          <div class="text-center mt-8">
            <button type="button" class="neon-button py-2 px-8 rounded-md font-medium try-again-btn">
              Try Again
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="py-6 px-4 sm:px-8 border-t border-gray-800">
    <div class="container mx-auto">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0">
          <p class="text-gray-400 text-sm">© 2025 SilentScan | Privacy-focused disease detection</p>
        </div>
        <div class="flex items-center space-x-4">
          <p class="text-gray-400 text-sm">Powered by AI/ML</p>
          <i class="fas fa-shield-alt text-neonBlue"></i>
          <p class="text-gray-400 text-sm">Privacy Protected</p>
        </div>
      </div>
    </div>
  </footer>

  <div id="disclaimer-modal" class="modal-overlay hidden">
    <div class="modal-content">
      <button class="modal-close-button" id="close-modal">&times;</button>
      <i class="fas fa-exclamation-triangle text-neonBlue text-4xl mb-4 animate-bounce-pulse"></i>
      <h3 class="text-2xl font-bold text-white mb-4">Important Disclaimer</h3>
      <p class="text-gray-300 mb-6">
        SilentScan is a **prototype for a hackathon** and provides **simulated risk assessments and analyses** for informational purposes only.
        <br><br>
        It is **NOT a medical device** and should **NOT be used for actual diagnosis, treatment, or medical advice.** Always consult with a qualified healthcare professional for any health concerns.
      </p>
      <button class="neon-button py-2 px-6" id="accept-disclaimer">I Understand & Accept</button>
    </div>
  </div>

  <div id="notification-area" class="notification hidden"></div>

  <script id="app-script">
    $(document).ready(function() {
      // --- Modal Logic ---
      const disclaimerAccepted = localStorage.getItem('silentscan_disclaimer_accepted');
      if (!disclaimerAccepted) {
        $('#disclaimer-modal').removeClass('hidden').addClass('animate-fade-in');
      }

      $('#accept-disclaimer, #close-modal').click(function() {
        $('#disclaimer-modal').addClass('animate-fade-out').one('animationend', function() {
          $(this).addClass('hidden').removeClass('animate-fade-out');
        });
        localStorage.setItem('silentscan_disclaimer_accepted', 'true');
      });

      // --- Notification Function ---
      function showNotification(message, type = 'info', duration = 3000) {
        const $notificationArea = $('#notification-area');
        $notificationArea.removeClass().addClass('notification').addClass(type).text(message).removeClass('hidden').addClass('animate-fade-in');

        setTimeout(() => {
          $notificationArea.addClass('animate-fade-out').one('animationend', function() {
            $(this).addClass('hidden').removeClass('animate-fade-out');
          });
        }, duration);
      }

      // --- Tab switching functionality ---
      $('.tab-button').click(function() {
        $('.tab-button').removeClass('tab-active');
        $(this).addClass('tab-active');
        
        const targetId = $(this).data('target');
        $('.tab-content').addClass('hidden');
        $(`#${targetId}`).removeClass('hidden');
      });

      // --- Try again button functionality ---
      $('.try-again-btn').click(function() {
        const formContainer = $(this).closest('.module-card');
        formContainer.find('form').show();
        formContainer.find('[id$="-result"]').addClass('hidden');
        // Reset specific form fields if needed (e.g., image preview)
        if (formContainer.find('#skin-form').length) {
            $('#image-preview').addClass('hidden').attr('src', '');
            $('#image-placeholder').removeClass('hidden');
            $('#skin-image').val(''); // Clear the file input
        }
        // Also reset checkboxes for STI and remove error states
        formContainer.find('input[type="checkbox"]').prop('checked', false);
        formContainer.find('input, select').removeClass('invalid'); // Remove error styles
        formContainer.find('.error-message').addClass('hidden'); // Hide error messages

        // Reset select options to first value if not required, or default to first if they are
        formContainer.find('select').each(function() {
          if ($(this).attr('required')) {
            $(this).val($(this).find('option:first').val());
          } else {
            $(this).val($(this).find('option:first').val()); // Or set to an empty string if allowed: $(this).val('');
          }
        });
        formContainer.find('input[type="number"], input[type="text"], input[type="date"]').val('');

        // Hide conditional STI/Skin fields on try again
        $('#sti-discharge-details').addClass('hidden');
        $('#sti-discharge-consistency-details').addClass('hidden');
        $('#sti-sores-details').addClass('hidden');
      });

      // --- Client-side form validation helper ---
      function validateForm(formId) {
        let isValid = true;
        $(`#${formId} [required]`).each(function() {
          const $input = $(this);
          const value = $input.val();
          const errorId = $input.attr('id') + '-error';
          const $errorMessage = $(`#${errorId}`);

          if (!value || (Array.isArray(value) && value.length === 0) || (typeof value === 'string' && value.trim() === '')) {
            $input.addClass('invalid');
            if ($errorMessage.length) $errorMessage.removeClass('hidden').text('This field is required.');
            isValid = false;
          } else if ($input.attr('type') === 'number') {
            const min = parseFloat($input.attr('min'));
            const max = parseFloat($input.attr('max'));
            const numVal = parseFloat(value);
            if (isNaN(numVal) || numVal < min || numVal > max) {
              $input.addClass('invalid');
              if ($errorMessage.length) $errorMessage.removeClass('hidden').text(`Please enter a number between ${min} and ${max}.`);
              isValid = false;
            } else {
              $input.removeClass('invalid');
              if ($errorMessage.length) $errorMessage.addClass('hidden');
            }
          }
          else {
            $input.removeClass('invalid');
            if ($errorMessage.length) $errorMessage.addClass('hidden');
          }
        });
        return isValid;
      }

      // --- Real-time input validation (on change/blur) ---
      $('input[type="number"], select').on('change blur', function() {
        const $input = $(this);
        const value = $input.val();
        const errorId = $input.attr('id') + '-error';
        const $errorMessage = $(`#${errorId}`);

        if ($input.attr('required') && (!value || (Array.isArray(value) && value.length === 0) || (typeof value === 'string' && value.trim() === ''))) {
          $input.addClass('invalid');
          if ($errorMessage.length) $errorMessage.removeClass('hidden').text('This field is required.');
        } else if ($input.attr('type') === 'number') {
          const min = parseFloat($input.attr('min'));
          const max = parseFloat($input.attr('max'));
          const numVal = parseFloat(value);
          if (isNaN(numVal) || numVal < min || numVal > max) {
            $input.addClass('invalid');
            if ($errorMessage.length) $errorMessage.removeClass('hidden').text(`Please enter a number between ${min} and ${max}.`);
          } else {
            $input.removeClass('invalid');
            if ($errorMessage.length) $errorMessage.addClass('hidden');
          }
        } else {
          $input.removeClass('invalid');
          if ($errorMessage.length) $errorMessage.addClass('hidden');
        }
      });


      // --- File input preview for skin analysis ---
      $('#skin-image').change(function() {
        const file = this.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            $('#image-preview').attr('src', e.target.result).removeClass('hidden');
            $('#image-placeholder').addClass('hidden');
          }
          reader.readAsDataURL(file);
        } else {
          $('#image-preview').addClass('hidden').attr('src', '');
          $('#image-placeholder').removeClass('hidden');
        }
      });
      
      $('#image-preview-container').click(function() {
        $('#skin-image').click();
      });

      // --- Conditional display for STI symptom details ---
      $('#sti-discharge').change(function() {
        if ($(this).is(':checked')) {
          $('#sti-discharge-details, #sti-discharge-consistency-details').removeClass('hidden');
        } else {
          $('#sti-discharge-details, #sti-discharge-consistency-details').addClass('hidden');
          $('#sti-discharge-color, #sti-discharge-consistency').val(''); // Clear values
        }
      });

      $('#sti-sores').change(function() {
        if ($(this).is(':checked')) {
          $('#sti-sores-details').removeClass('hidden');
        } else {
          $('#sti-sores-details').addClass('hidden');
          $('#sti-sores-description').val(''); // Clear value
        }
      });

      // --- Form submissions ---
      $('#breast-cancer-form').submit(async function(e) {
        e.preventDefault();
        if (!validateForm('breast-cancer-form')) {
          showNotification('Please fill in all required fields and correct errors.', 'error');
          return;
        }

        const submitButton = $(this).find('button[type="submit"]');
        const originalButtonHtml = submitButton.html();
        submitButton.html('<div class="spinner mr-2"></div> Analyzing...');
        
        const features = {
          age: parseInt($('#bc-age').val()),
          family_history: parseInt($('#bc-family-history').val()),
          previous_biopsy: parseInt($('#bc-previous-biopsy').val()),
          chest_radiation: parseInt($('#bc-chest-radiation').val()),
          genetic_mutation: parseInt($('#bc-genetic-mutation').val()),
          menstrual_age: parseInt($('#bc-menstrual-age').val()),
          first_pregnancy: parseInt($('#bc-first-pregnancy').val()),
          num_pregnancies: parseInt($('#bc-num-pregnancies').val()),
          breastfed: parseInt($('#bc-breastfed').val()),
          menopause_age: parseInt($('#bc-menopause-age').val()),
          density: parseInt($('#bc-density').val()),
          hormone_therapy: parseInt($('#bc-hormone-therapy').val()),
          alcohol: parseInt($('#bc-alcohol').val()),
          physical_activity: parseInt($('#bc-physical-activity').val())
        };
        
        try {
          const response = await fetch('https://magicloops.dev/api/loop/0f802499-8dde-4dc2-bc2a-79a8003ea49a/run', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ features })
          });
          
          if (!response.ok) {
            throw new Error(`Server returned ${response.status}: ${await response.text()}`);
          }
          
          const data = await response.json();
          
          $(this).hide();
          $('#breast-cancer-result').removeClass('hidden');
          $('#bc-risk-level').text(data.risk_level || 'Unknown');
          
          const probability = data.probability ? (data.probability * 100).toFixed(0) : 45;
          $('#bc-risk-bar').css('width', `${probability}%`);
          
          $('#bc-guidance').text(data.guidance || 'Please consult a healthcare professional for medical advice.');
          showNotification('Breast Cancer Risk analyzed successfully!', 'success');
          
        } catch (error) {
          console.error('Error submitting breast cancer form:', error);
          showNotification('Failed to analyze risk: ' + error.message, 'error');
        } finally {
          submitButton.html(originalButtonHtml);
        }
      });
      
      // NEW TESTICULAR CANCER FORM SUBMISSION
      $('#testicular-cancer-form').submit(async function(e) {
        e.preventDefault();
        if (!validateForm('testicular-cancer-form')) {
          showNotification('Please fill in all required fields and correct errors.', 'error');
          return;
        }

        const submitButton = $(this).find('button[type="submit"]');
        const originalButtonHtml = submitButton.html();
        submitButton.html('<div class="spinner mr-2"></div> Analyzing...');
        
        const features = {
          age: parseInt($('#tc-age').val()),
          race: $('#tc-race').val(),
          undescended_testicle: parseInt($('#tc-undescended-testicle').val()),
          family_history: parseInt($('#tc-family-history').val()),
          previous_cancer: parseInt($('#tc-previous-cancer').val()),
          klinefelter: parseInt($('#tc-klinefelter').val()),
          hiv: parseInt($('#tc-hiv').val()),
          mumps_orchitis: parseInt($('#tc-mumps-orchitis').val()),
          injury: parseInt($('#tc-injury').val())
        };

        try {
          const response = await fetch('http://localhost:3000/api/testicular-cancer', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ features })
          });
          
          if (!response.ok) {
            throw new Error(`Server returned ${response.status}: ${await response.text()}`);
          }
          
          const data = await response.json();
          
          $(this).hide();
          $('#testicular-cancer-result').removeClass('hidden');
          $('#tc-risk-level').text(data.risk_level || 'Unknown');
          
          const probability = data.probability ? (data.probability * 100).toFixed(0) : 50;
          $('#tc-risk-bar').css('width', `${probability}%`);
          
          $('#tc-guidance').text(data.guidance || 'Please consult a healthcare professional for medical advice.');
          showNotification('Testicular Cancer Risk analyzed successfully!', 'success');
          
        } catch (error) {
          console.error('Error submitting testicular cancer form:', error);
          showNotification('Failed to analyze risk: ' + error.message, 'error');
        } finally {
          submitButton.html(originalButtonHtml);
        }
      });
      
      $('#pcos-form').submit(async function(e) {
        e.preventDefault();
        if (!validateForm('pcos-form')) {
          showNotification('Please fill in all required fields and correct errors.', 'error');
          return;
        }

        const submitButton = $(this).find('button[type="submit"]');
        const originalButtonHtml = submitButton.html();
        submitButton.html('<div class="spinner mr-2"></div> Analyzing...');
        
        const weight = parseFloat($('#pcos-weight').val());
        const heightInM = parseFloat($('#pcos-height').val()) / 100;
        const bmi = weight / (heightInM * heightInM);
        
        const features = {
          age: parseInt($('#pcos-age').val()),
          weight: weight,
          height: parseFloat($('#pcos-height').val()),
          bmi: parseFloat(bmi.toFixed(1)),
          weight_gain: parseInt($('#pcos-weight-gain').val()),
          difficulty_losing_weight: parseInt($('#pcos-difficulty-losing-weight').val()),
          regular_periods: parseInt($('#pcos-cycle').val()),
          cycle_length: parseInt($('#pcos-cycle-length').val()),
          periods_per_year: parseInt($('#pcos-periods-per-year').val()),
          hair_growth: parseInt($('#pcos-hair-growth').val()),
          hair_loss: parseInt($('#pcos-hair-loss').val()),
          acne_severity: parseInt($('#pcos-acne-severity').val()),
          skin_darkening: parseInt($('#pcos-skin').val()),
          ovarian_cysts: parseInt($('#pcos-ovarian-cysts').val()),
          gestational_diabetes: parseInt($('#pcos-gestational-diabetes').val()),
          family_diabetes: parseInt($('#pcos-family-diabetes').val()),
          insulin_resistance: parseInt($('#pcos-insulin-resistance').val()),
          anxiety_depression: parseInt($('#pcos-anxiety-depression').val()),
          sleep_issues: parseInt($('#pcos-sleep-issues').val())
        };
        
        try {
          const response = await fetch('http://localhost:3000/api/pcos', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ features })
          });
          
          if (!response.ok) {
            throw new Error(`Server returned ${response.status}: ${await response.text()}`);
          }
          
          const data = await response.json();
          
          $(this).hide();
          $('#pcos-result').removeClass('hidden');
          $('#pcos-risk-level').text(data.risk_level || 'Unknown');
          
          const probability = data.probability ? (data.probability * 100).toFixed(0) : 50;
          $('#pcos-risk-bar').css('width', `${probability}%`);
          
          $('#pcos-guidance').text(data.guidance || 'Please consult a healthcare professional for medical advice.');
          showNotification('PCOS Risk analyzed successfully!', 'success');
          
        } catch (error) {
          console.error('Error submitting PCOS form:', error);
          showNotification('Failed to analyze risk: ' + error.message, 'error');
        } finally {
          submitButton.html(originalButtonHtml);
        }
      });
      
      $('#sti-form').submit(async function(e) {
        e.preventDefault();
        if (!validateForm('sti-form')) {
          showNotification('Please fill in all required fields and correct errors.', 'error');
          return;
        }

        const submitButton = $(this).find('button[type="submit"]');
        const originalButtonHtml = submitButton.html();
        submitButton.html('<div class="spinner mr-2"></div> Analyzing...');
        
        const symptoms = [];
        $('input[name="symptoms"]:checked').each(function() {
          symptoms.push($(this).val());
        });

        const detailedFeatures = {
          symptoms: symptoms,
          symptom_onset: $('#sti-symptom-onset').val(),
          symptom_change: $('#sti-symptom-change').val(),
          discharge_color: $('#sti-discharge-color').val(),
          discharge_consistency: $('#sti-discharge-consistency').val(),
          sores_description: $('#sti-sores-description').val(),
          partners_last_months: $('#sti-partners-last-months').val() ? parseInt($('#sti-partners-last-months').val()) : null,
          sexual_contact_type: $('#sti-sexual-contact-type').val(),
          condom_usage: $('#sti-condom-usage').val(),
          last_unprotected: $('#sti-last-unprotected').val(),
          partner_symptoms: $('#sti-partner-symptoms').val(),
          previous_diagnosis: $('#sti-previous-diagnosis').val()
        };
        
        try {
          const response = await fetch('http://localhost:3000/api/sti', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(detailedFeatures)
          });
          
          if (!response.ok) {
            throw new Error(`Server returned ${response.status}: ${await response.text()}`);
          }
          
          const data = await response.json();
          
          $(this).hide();
          $('#sti-result').removeClass('hidden');
          
          $('#sti-conditions').empty();
          
          if (data.predictions && Object.keys(data.predictions).length > 0) {
            Object.entries(data.predictions).forEach(([condition, probability]) => {
              const percentMatch = (probability * 100).toFixed(0);
              $('#sti-conditions').append(`
                <div class="p-3 border border-gray-700 rounded-lg">
                  <div class="flex justify-between items-center">
                    <span class="text-gray-300 font-medium">${condition}</span>
                    <span class="text-neonBlue">${percentMatch}% match</span>
                  </div>
                  <div class="w-full bg-gray-700 rounded-full h-2 mt-2">
                    <div class="result-bar" style="width: ${percentMatch}%"></div>
                  </div>
                </div>
              `);
            });
          } else {
            $('#sti-conditions').append('<p class="text-gray-300">No significant matches found for the selected symptoms. Please try selecting more symptoms or consult a healthcare professional if you have concerns.</p>');
          }
          
          $('#sti-guidance').text(data.guidance || 'Please consult a healthcare professional for medical advice.');
          showNotification('STI Symptom analysis complete!', 'success');
          
        } catch (error) {
          console.error('Error submitting STI form:', error);
          showNotification('Failed to analyze symptoms: ' + error.message, 'error');
        } finally {
          submitButton.html(originalButtonHtml);
        }
      });
      
      $('#skin-form').submit(async function(e) {
        e.preventDefault();
        // Basic file input validation as it's not handled by validateForm
        if (!$('#skin-image')[0].files[0]) {
          showNotification('Please upload an image for skin analysis.', 'error');
          return;
        }
        if (!validateForm('skin-form')) {
          showNotification('Please fill in all required fields and correct errors.', 'error');
          return;
        }
        
        const submitButton = $(this).find('button[type="submit"]');
        const originalButtonHtml = submitButton.html();
        submitButton.html('<div class="spinner mr-2"></div> Analyzing...');
        
        const file = $('#skin-image')[0].files[0];
        const bodyLocation = $('#skin-location').val();
        
        const formData = new FormData();
        formData.append('image', file);
        formData.append('body_location', bodyLocation);
        formData.append('onset', $('#skin-onset').val());
        formData.append('change_recent', $('#skin-change').val());
        formData.append('itchy', $('#skin-itchy').val());
        formData.append('painful', $('#skin-painful').val());
        formData.append('raised_flat', $('#skin-raised-flat').val());
        formData.append('discharge', $('#skin-discharge').val());
        formData.append('appearance', JSON.stringify($('#skin-appearance').val()));
        formData.append('triggers', $('#skin-triggers').val());
        formData.append('allergies_eczema', $('#skin-allergies-eczema').val());
        formData.append('medications', $('#skin-medications').val());

        try {
          const response = await fetch('http://localhost:3000/api/skin', {
            method: 'POST',
            body: formData
          });
          
          if (!response.ok) {
            throw new Error(`Server returned ${response.status}: ${await response.text()}`);
          }
          
          const data = await response.json();
          
          $(this).hide();
          $('#skin-result').removeClass('hidden');
          
          const imageUrl = $('#image-preview').attr('src');
          $('#result-image-preview').attr('src', imageUrl);
          
          $('#skin-condition-name').text(data.condition || 'Unknown Condition');
          
          const confidence = data.confidence ? (data.confidence * 100).toFixed(0) : 0;
          $('#skin-confidence').text(`${confidence}%`);
          $('#skin-confidence-bar').css('width', `${confidence}%`);
          
          $('#skin-guidance').text(data.guidance || 'Please consult a healthcare professional for medical advice.');
          showNotification('Skin analysis complete!', 'success');
          
        } catch (error) {
          console.error('Error submitting skin form:', error);
          showNotification('Failed to analyze image: ' + error.message, 'error');
        } finally {
          submitButton.html(originalButtonHtml);
        }
      });
    });
  </script>
</body>
</html>